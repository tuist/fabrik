# cbindgen configuration for Fabrik C API
# This generates the C header file from Rust FFI code

language = "C"
header = """/* Fabrik Cache C API
 *
 * Thread-safe C API for integrating Fabrik cache into external toolchains.
 *
 * ## Example Usage
 *
 * ```c
 * #include "fabrik.h"
 * #include <stdio.h>
 *
 * int main() {
 *     // Initialize cache
 *     FabrikCache *cache = fabrik_cache_init("/tmp/fabrik-cache");
 *     if (!cache) {
 *         fprintf(stderr, "Failed to initialize cache: %s\\n", fabrik_last_error());
 *         return 1;
 *     }
 *
 *     // Store artifact
 *     const char *data = "Hello, World!";
 *     const char *hash = "abc123def456";
 *     if (fabrik_cache_put(cache, hash, (const uint8_t*)data, 13) != FABRIK_OK) {
 *         fprintf(stderr, "Failed to put: %s\\n", fabrik_last_error());
 *     }
 *
 *     // Check existence
 *     int exists = 0;
 *     if (fabrik_cache_exists(cache, hash, &exists) == FABRIK_OK) {
 *         printf("Artifact exists: %d\\n", exists);
 *     }
 *
 *     // Retrieve artifact
 *     uint8_t buffer[1024];
 *     size_t bytes_read = 0;
 *     if (fabrik_cache_get(cache, hash, buffer, sizeof(buffer), &bytes_read) == FABRIK_OK) {
 *         printf("Retrieved %zu bytes\\n", bytes_read);
 *     }
 *
 *     // Cleanup
 *     fabrik_cache_free(cache);
 *     return 0;
 * }
 * ```
 *
 * ## Memory Management
 *
 * - All cache handles must be freed with `fabrik_cache_free()`
 * - Error strings are owned by the library and should not be freed
 * - All functions are thread-safe
 *
 * ## Error Handling
 *
 * All functions return error codes. Use `fabrik_last_error()` to get
 * the error message for the current thread.
 *
 * Copyright (c) 2025 Tuist GmbH
 * Licensed under MIT License
 */"""

include_guard = "FABRIK_H"
autogen_warning = "/* Warning: This file is auto-generated by cbindgen. Do not modify. */"
pragma_once = true
include_version = true
tab_width = 4
documentation = true
documentation_style = "c"

[export]
include = ["FabrikCache"]
prefix = "Fabrik"

[export.rename]
"FabrikCache" = "FabrikCache"

[fn]
prefix = "fabrik_"
rename_args = "GeckoCase"

[defines]
"target_os = windows" = "FABRIK_WINDOWS"
"target_os = macos" = "FABRIK_MACOS"
"target_os = linux" = "FABRIK_LINUX"

[parse]
parse_deps = false
include = ["fabrik"]
clean = false
